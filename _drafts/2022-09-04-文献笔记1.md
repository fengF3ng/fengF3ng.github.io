---
title: 文献笔记-幽灵攻击
date: 2022-09-04 10:10:00 +0800
categories: [Research, Arch]
tags: [spectre attack, meltdown attack, cpu]     # TAG names should always be lowercase
---


初看论文的时候把这两个当成了一回事纠结了很久。在stackoverflow上有人形象地比喻解释了这两个概念。

> Car analogy: You drive a car, I have the map. I say “I think you need to turn left” = branch prediction. You turn left = speculative execution. Later I tell you if the turn was correct or wrong.

大多数术语都是认识的，但有时候会有点遗忘。

乱序执行、超标量、流水线和超线程等等

# 论文内容


# 复现

## 用户空间泄露

一个c文件就能搞定的攻击，整体利用较为简单。在普通的linux上就能跑通，而且貌似没有修复。

## js

需要较低版本的chrome，跑了两个版本的攻击代码，其中一个成功了。

https://www.chromedownloads.net/chrome64win/

## ebpf

服务器linux内核太旧，本地虚拟机内核太新，于是决定自己重新编译一个内核。

参考了资料，wsl2更换linux内核需要按照微软给出的配置编译，最后在.wslconfig文件中设置为启动内核。

但在编译过程中一直出现以下错误，之前的重定位问题通过修改CC变量加入-no-pie -fno-pic解决，但这个一直无法解决。

```console
Unsupported relocation type: R_X86_64_PLT32 (4)
make[2]: *** [arch/x86/boot/compressed/Makefile:70: arch/x86/boot/compressed/vmlinux.relocs] Error 1
make[1]: *** [arch/x86/boot/Makefile:111: arch/x86/boot/compressed/vmlinux] Error 2
make: *** [arch/x86/Makefile:251: bzImage] Error 2
```

https://zhuanlan.zhihu.com/p/324530180
https://github.com/microsoft/WSL2-Linux-Kernel
https://docs.microsoft.com/en-us/windows/wsl/wsl-config#configure-global-options-with-wslconfig
https://bbs.csdn.net/topics/605897517
https://www.cnblogs.com/y-c-y/p/14140741.html

# reference

1. [分支预测，uOP，乱序执行](https://zhuanlan.zhihu.com/p/349758402)
2. [CPU中所谓的预测执行（Speculative Execution）](https://zhuanlan.zhihu.com/p/157233356)
3. [看懂这篇，才能说了解并发底层技术](https://www.cnblogs.com/jiagoujishu/p/13799459.html)
4. [全面介绍eBPF-概念](https://www.cnblogs.com/charlieroro/p/13403672.html)