---
title: 数据库
date: 2022-10-11 13:42:00 +0800
categories: [Web, Basic]
tags: [database]     # TAG names should always be lowercase
---

# 数据库分类

数据库通常分为层次式数据库、网络式数据库和关系式数据库三种。而不同的数据库是按不同的数据结构来联系和组织的。

而在当今的互联网中，最常见的数据库模型主要是两种，即关系型数据库和非关系型数据库。

## 关系型数据库

关系型数据库模型是把复杂的数据结构归结为简单的二元关系（即二维表格形式）。在关系型数据库中，对数据的操作几乎全部建立在一个或多个关系表格上，通过对这些关联的表格分类、合并、连接或选取等运算来实现数据库的管理。

## 非关系型数据库

NoSql数据库在特定的场景下可以发挥出难以想象的高效率和高性能，它是作为对传统关系型数据库的一个有效的补充。

1. 键值存储数据库（key-value）：Memcached、Redis、MemcacheDB
2. 列存储（Column-oriented）数据库：Cassandra、HBase
3. 面向文档（Document-Oriented）数据库：MongoDB、CouchDB
4. 图形数据库：Neo4J、InforGrid

![Window shadow](/assets/img/2022-10/2022-10-11-%E6%95%B0%E6%8D%AE%E5%BA%93/rdb_market.png){: .shadow}
_sql vs nosql_

## 具体数据库

数据库|类别|应用场景|排名
--|--|--|--
Oracle|关系型数据库|金融、电信、制造业等大中型企业|1
MySQL|关系型数据库|大中型企业、互联网|2
MongoDB|文档数据库|Web应用，存储面向文档或类似半结构化的数据|5
Redis|键值数据库|内容缓存，如会话、配置文件、参数等频繁读写、拥有简单数据模型的应用|6
MariaDB|关系型数据库|数据云灾备（异地灾备）、业务系统上云、混合云、读写分离、开发测试|12
ArangoDB|多模型数据库|制造业、身份识别与访问控制、网络安全、模拟、机器学习|71


# MySQL

mysql中采用的是poll/select的线程池模型（如下图，这里mysql没有采用epoll实现reactor模式的网络架构，是因为mysql的瓶颈并不在网络IO，而是更多地把精力专注于sql的执行效率优化上）

![Window shadow](/assets/img/2022-10/2022-10-11-%E6%95%B0%E6%8D%AE%E5%BA%93/mysql.jpg){: .shadow}
_mysql_

# Redis

目前所说的Redis单线程，指的是"其网络IO和键值对读写是由一个线程完成的"，也就是说，Redis中只有网络请求模块和数据操作模块是单线程的。而其他的如持久化存储模块、集群支撑模块等是多线程的。

所以说，Redis中并不是没有多线程模型的，早在Redis 4.0的时候就已经针对部分命令做了多线程化。主要是体现在大数据的异步删除功能上，例如unlink key、flushdb async、flushall async等。

Redis的操作基本都是基于内存的，**CPU资源根本就不是Redis的性能瓶颈**，所以Redis不需要通过多线程技术来提升CPU利用率。

Redis 6.0中的多线程，也只是针对处理网络请求过程采用了多线程，而数据的**读写命令，仍然是单线程**处理的。

随着业务场景越来越复杂，限制Redis性能的**主要瓶颈出现在网络IO**的处理上，多路复用的IO模型本质上仍然是同步阻塞型IO模型。采用多线程，使得网络处理的请求并发进行，就可以大大的提升性能。多线程除了可以减少由于网络 I/O 等待造成的影响，还可以充分利用 CPU 的多核优势。

此外redis还有数据持久化、主从复制、哨兵、分片集群等概念

# MongoDB

MongoDB是一个基于文档型数据库，MongoDB中文档数据，使用BSON（一种和JSON类似的）东西作为数据格式。

使用文档作为数据格式有如下好处

- 数据结构符合大部分程序语言。
- 可在文档内嵌入子文档（相当于传统数据库的嵌套表）。
- 动态增减文档或修改文档格式。

具备以下关键特性

- 高性能：支持使用嵌入数据时，减少系统I/O负担，支持子文档查询
- 多种查询类型支持，且支持数据聚合查询、文本检索、地址位置查询
- 高可用、水平扩展：支持副本集与分片
- 多种存储引擎：WiredTiger , In-Memory

# MariaDB

云数据库 MariaDB（TencentDB for MariaDB）是应用于 OLTP 场景下的高安全性的企业级云数据库，一直应用于腾讯计费业务，MariaDB 兼容 MySQL 语法，不仅拥有诸如线程池、审计、异地容灾等高级功能，同时具有云数据库的易扩展性、简单性和高性价比。

核心特性

1. 高一致性
2. 高可用性
3. 高性能

# ArangoDB

支持图形、文档和键值的多模型数据库

# reference

1. [超全的数据库分类介绍](https://zhuanlan.zhihu.com/p/101606473)
2. [Relational Database Market - Forecast(2022 - 2027)](https://www.industryarc.com/Report/19213/relational-database-market.html)
3. [DB-Engines](https://db-engines.com/en/)
4. [mysql整体架构](https://zhuanlan.zhihu.com/p/262570892)
5. [一文搞懂 Redis 架构演化之路](https://www.cnblogs.com/88223100/p/An-article-to-understand-the-evolution-of-Redis-architecture.html)
6. [Redis是单线程还是多线程？](https://zhuanlan.zhihu.com/p/360335981)
7. [MongoDB 介绍与应用详解](https://zhuanlan.zhihu.com/p/84834695)
8. [云数据库 MariaDB](https://cloud.tencent.com/document/product/237)